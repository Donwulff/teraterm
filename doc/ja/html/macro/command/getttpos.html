<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
  <title>getttpos</title>
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="../../style.css" type="text/css">
</head>

<body>


<h1>getttpos</h1>

<p>
Tera Term の VT window のテキスト領域の位置、サイズ、最小化状態を取得する。<em>(バージョン5.3以降)</em>
</p>

<h2>形式</h2>

<pre class="macro-syntax">
getttpos &lt;x&gt; &lt;y&gt; &lt;width&gt; &lt;height&gt; &lt;minimized&gt;
</pre>

<h2>パラメータ</h2>

<dl>
	<dt class="macro">整数型変数 &lt;x&gt;</dt>
	<dd>テキスト領域左上隅の X 座標が格納される。(単位:ピクセル)<br>
	    VT windowが最小化状態の場合は誤った値が格納される。</dd>

	<dt class="macro">整数型変数 &lt;y&gt;</dt>
	<dd>テキスト領域左上隅の Y 座標が格納される。(単位:ピクセル)<br>
	    VT windowが最小化状態の場合は誤った値が格納される。</dd>

	<dt class="macro">整数型変数 &lt;width&gt;</dt>
	<dd>テキスト領域の幅が格納される。(単位:ピクセル)<br>
	    VT windowが最小化状態の場合は誤った値が格納される。</dd>

	<dt class="macro">整数型変数 &lt;height&gt;</dt>
	<dd>テキスト領域の高さが格納される。(単位:ピクセル)<br>
	    VT windowが最小化状態の場合は誤った値が格納される。</dd>
	</dd>

	<dt class="macro">整数型変数 &lt;minimized&gt;</dt>
	<dd>VT windowの最小化状態が格納される。<br>
            0 : 通常状態<br>
            1 : 最小化状態</dd>
</dl>

<h2>返り値</h2>

<dl>
	<dt class="macro">システム変数 &lt;result&gt;</dt>
	<dd>情報取得に成功した場合は 0 が、失敗した場合は -1 が格納される。</dd>
</dl>

<h2>解説</h2>

<p>
&lt;x&gt; と &lt;y&gt; は画面の座標 (X,Y) を表わす。原点 (0,0) はメインディスプレイ(プライマリディスプレイ)の左上隅の位置。<br>
MACRO が Tera Term とリンクされていない場合は、マクロエラーとなりマクロの実行が一次停止する。
</p>

<h2>例</h2>

<pre class="macro-example">
testlink
if result > 1 then
:start
  getttpos x y width height minimized
  if minimized = 1 then
    showtt 1
    goto start
  endif
  setdlgpos x y
  sprintf2 str 'x=%d, y=%d, width=%d, height=%d' x y width height
  messagebox str 'x,y = top-left of the text area'
endif
</pre>

<h2>参照</h2>
<ul>
  <li><a href="testlink.html">testlink</a></li>
  <li><a href="showtt.html">showtt</a></li>
  <li><a href="setdlgpos.html">setdlgpos</a></li>
</ul>

</body>
</html>
